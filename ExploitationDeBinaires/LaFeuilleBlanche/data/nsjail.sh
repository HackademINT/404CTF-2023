#!/bin/bash

mkdir /sys/fs/cgroup/{cpu,memory,pids}/NSJAIL

nsjail \
    -Ml --port 4444 \
    --user nobody:nobody \
    --group nogroup:nogroup \
    --hostname localhost \
    --cwd /app \
    -R /app/la_feuille_blanche \
    -R /app/flag.txt \
    -R /lib \
    -R /lib32 \
    -R /libx32 \
    -R /lib64 \
    -R /bin/bash \
    -R /bin/sh \
    -R /bin/ls \
    -R /bin/cat \
    --detect_cgroupv2 \
    --time_limit 30 \
    --cgroup_pids_max 4 \
    --cgroup_mem_max 67108864 \
    --cgroup_cpu_ms_per_sec 100 \
    -- $@