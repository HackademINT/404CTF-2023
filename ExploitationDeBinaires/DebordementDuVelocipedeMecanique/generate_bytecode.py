# PWN MY VM :

nice_name = b"! That's a really nice name!\n\x00"
what_name = b"What's your name?\n\x00"
filename = b".passwd\x00"

code = b"  \x01\x09read_flag\x02" + \
       b":FS" + \
       b"|" + len(filename).to_bytes(4, byteorder="little") + filename + \
       b":AS" + \
       b"#B" + (31).to_bytes(4, byteorder='little') + \
       b"/:AS$" + \
       b":SF)" + \
       b"\x01\x08say_name\x02" + \
       b":FS" + \
       b"|" + len(nice_name).to_bytes(4, byteorder="little") + nice_name + \
       b":DS" + \
       b"|" + len(what_name).to_bytes(4, byteorder="little") + what_name + \
       b":AS$" + \
       b"#B" + (20).to_bytes(4, byteorder='little') + \
       b"%" + \
       b":AS$" + \
       b":AD$" + \
       b":SF)" + \
       b"\x01\x04main\x02" + \
       b"(\x08say_name" + \
       b'^AA.'


FILE_NAME = "pwn_my_vm"

with open(FILE_NAME + ".vmr", "wb+") as f:
    f.write(code)
